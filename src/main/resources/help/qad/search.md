# 搜索

<div class="alert alert-info">适用于管理员</div>

术语和概念
-----------------

看板使用[ElasticSearch](http://www.elasticsearch.org)作为后台搜索引擎。
搜索引擎通过JDBC方式**定期**扫描目标数据库（存储资产、审计等原始数据的数据库），并将索引保存在引擎本地的文件系统中。

__搜索索引 index__
:    索引相当于关系数据库中的 *数据库* 。一个索引下面可以定义多种类型。看板的搜索引擎将索引保存在文件系统中。为方便维护，看板使用唯一的一个索引kanban。

__搜索类型 type__
:    类型相当于关系数据库中的 *表* ，表示要搜索的对象类别。以Google搜索为类比，文档、网页、图像、视频分别属于不同的类型。一个类型包含多个文档。
看板需要为每类搜索对象（例如用户、HMC、DB、OS、LPAR、ETH等）创建一个搜索类型。一个搜索类型对应一个 *CI类型* 。

__搜索文档 document__
:    文档相当于关系数据库中表的 *记录* 。每个文档作为一个JSON字符串存储在索引中，包含多个字段或者键值对，其中两个关键字段为：类型（_type），ID（_id）。原始JSON文档将被存储在索引的_source字段。
    
__CI类型__
:    Configuration Item Type，配置项类型，指的是看板内部定义的对象类型，用于看板的开发、权限的配置等。一个搜索类型需要对应一个唯一的CI类型（CI Type）。需要和UCMDB中的CI区分开来。

如何添加搜索
-----------------

1. 定义 *索引方案* : 需要确保索引的数据库IP、用户名和密码正确
2. 定义 *CI类型* : 建议从Excel中导入。
3. 在<a href="${base}/admin/config/search" target="_blank">搜索管理</a>中更新CI的索引定义，让搜索引擎重新索引。

搜索配置
-----------------

可配置搜索参数

- 启动和停止搜索引擎的命令
- 搜索字段的翻译：将搜索出来的字段翻译成容易看懂的字段名称
- 索引库的名称：重要，必须和索引方案中定义的保持一致
- 搜索引擎URL

`admin/config/search/settings/list`


查看日志：`/usr/opshere/elasticsearch/logs/kanban-elasticsearch.log`.
